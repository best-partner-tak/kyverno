# file path relative to project root
input:
  policy: samples/best_practices/policy_validate_deny_runasrootuser.yaml
  resource: test/scenarios/resources/resource_validate_nonRootUser.yaml
expected:
  validation:
    policyresponse:
      policy: validate-deny-runasrootuser
      resource:
        kind: Pod
        apiVersion: v1
        namespace: ''
        name: sec-ctx-unprivileged
      rules:
        - name: deny-runasrootuser
          type: Validation
          message: Validation rule 'deny-runasrootuser' failed to validate patterns defined in anyPattern. Root user is not allowed. Set runAsNonRoot to true.; anyPattern[0] failed at path /spec/securityContext/; anyPattern[1] failed at path /spec/containers/0/securityContext/
          success: false