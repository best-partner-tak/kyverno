
# file path relative to project root
input:
  policy: examples/best_practices/policy_validate_disallow_sysctl.yaml
  resource: examples/best_practices/resources/resource_disallow_sysctl.yaml
expected:
  validation:
    policyresponse:
      policy: validate-allow-portrange-with-sysctl
      resource:
        kind: Pod
        apiVersion: v1
        namespace: ''
        name: nginx
      rules:
        - name: allow-portrange-with-sysctl
          type: Validation
          message: "Validation rule 'allow-portrange-with-sysctl' failed at '/spec/securityContext/sysctls/0/value/' for resource Pod//nginx. Allowed port range is from 1024 to 65535"
          success: false