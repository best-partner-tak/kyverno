# file path relative to project root
input:
  policy: examples/best_practices/policy_validate_disallow_default_serviceaccount.yaml
  resource: examples/best_practices/resources/resource_validate_disallow_default_serviceaccount.yaml
expected:
  validation:
    policyresponse:
      policy: validate-disallow-default-serviceaccount
      resource:
        kind: Pod
        apiVersion: v1
        namespace: ''
        name: pod-with-default-sa
      rules:
        - name: prevent-mounting-default-serviceaccount
          type: Validation
          message: Validation rule 'prevent-mounting-default-serviceaccount' failed at '/spec/serviceAccountName/' for resource Pod//pod-with-default-sa. Prevent mounting of default service account.
          success: false